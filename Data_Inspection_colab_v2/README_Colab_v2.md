# Data_Inspection_colab_v2 - 町丁一貫性100%達成パイプライン

## 概要
このディレクトリには、`Data_Inspection/`配下で実際に100%一貫性を達成した**完全に同じロジック**のスクリプトが含まれています。

## 実行順序（ローカルと同じ）

### ステップ1: HTMLファイルからのデータ抽出
```python
!python main_preprocessing_colab.py
```
- `Data/`配下のHTMLベースXLSファイルからデータを抽出
- `Data_csv/`にCSVファイルとして保存

### ステップ2: 町丁一貫性分析
```python
!python check_town_consistency.py
```
- 現状の町丁一貫性率を分析
- 可視化ファイルを生成

### ステップ3: 町丁データ統合（重要！）
```python
!python merge_town_data_improved.py
```
- **これが100%達成の核心スクリプト**
- 年齢区分やヘッダー行を除外
- 有効な町丁名のみを抽出
- 町丁名の正規化（区名削除、空白削除）
- 合併町の処理（2009年以前は0人口で補完）
- **100%の一貫性を持つデータの生成**

### ステップ4: 2009年合併町NaN埋め
```python
!python fill_2009_merged_towns.py
```
- 2009年合併町の前年度データをNaNで補完

### ステップ5: 区制町丁統一
```python
!python unify_district_towns.py
```
- 区名付き町丁（例：`京町本丁（中央区）`）を統一

### ステップ6: 100%一貫性達成の最終統一
```python
!python final_solution_100_percent.py
```
- 強制的に区名を除去
- 最終的な100%一貫性を達成

## 検証
```python
!python verify_100_percent_final.py
```
- 最終的な町丁一貫性率を確認

## 重要なポイント
- **ステップ3の`merge_town_data_improved.py`**が最も重要
- ローカルで100%達成した**完全に同じロジック**を使用
- パスのみColab用に修正済み
- 処理内容は一切変更なし

## 期待される結果
- 最終的な町丁一貫性率: **100%**
- 全28年度で一貫した町丁名
- 区名付き町丁の完全除去
- 合併町の適切な処理

## 注意事項
- 各ステップは順番に実行する必要があります
- 前のステップの出力が次のステップの入力になります
- ステップ3が最も重要な処理です
